<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Form</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        button {
            width: 100%;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        #results {
            margin-top: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .request-button {
            padding: 5px 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .request-button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Search Details</h1>

        <label for="blood-group">Blood Group:</label>
        <select id="blood-group">
            <option value="">Select Blood Group</option>
            <option value="A+">A+</option>
            <option value="B+">B+</option>
            <option value="O+">O+</option>
            <option value="AB+">AB+</option>
            <option value="A-">A-</option>
            <option value="B-">B-</option>
            <option value="O-">O-</option>
            <option value="AB-">AB-</option>
        </select>

        <label for="state">State:</label>
        <select id="state">
            <option value="">Select State</option>
        </select>

        <label for="district">District:</label>
        <select id="district">
            <option value="">Select District</option>
        </select>

        <label for="taluka">Taluka:</label>
        <select id="taluka">
            <option value="">Select Taluka</option>
        </select>

        <label for="city">City:</label>
        <select id="city">
            <option value="">Select City</option>
        </select>

        <button id="search-button">Search</button>

        <div id="results">
            <!-- Results will be displayed here -->
        </div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        // Initialize Google Sheets API client
        function initApi() {
            gapi.client.init({
                'apiKey': 'AIzaSyAAUcnGIsBkyDvmwhPKBiDSQmni0kBsPvY',
                'clientId': '554999076826-7bpohlckvv9cam99qco69105ntua2o1l.apps.googleusercontent.com',
                'scope': 'https://www.googleapis.com/auth/spreadsheets.readonly',
                'discoveryDocs': ["https://sheets.googleapis.com/$discovery/rest?version=v4"]
            }).then(function () {
                console.log("Google API Initialized");
            });
        }

        gapi.load("client", initApi);

        // Function to fetch data from Google Sheets
        function fetchData() {
            const bloodGroup = document.getElementById("blood-group").value;
            const state = document.getElementById("state").value;
            const district = document.getElementById("district").value;
            const taluka = document.getElementById("taluka").value;
            const city = document.getElementById("city").value;

            // Your Google Sheets ID
            const spreadsheetId = '1WIkhvWJYPY8vN03fwcJfdbvr3-wZbYNrpKotDZlrq28';
            const range = 'Sheet1!A1:E100'; // Adjust as per your data range

            const request = gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: spreadsheetId,
                range: range,
            });

            request.then(function (response) {
                const data = response.result.values;
                const filteredData = data.filter(row => {
                    return (bloodGroup ? row[0] === bloodGroup : true) &&
                           (state ? row[1] === state : true) &&
                           (district ? row[2] === district : true) &&
                           (taluka ? row[3] === taluka : true) &&
                           (city ? row[4] === city : true);
                });

                displayResults(filteredData);
            }, function (error) {
                console.error("Error fetching data: " + error);
            });
        }

        // Function to display the results
        function displayResults(data) {
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = ""; // Clear previous results

            if (data.length === 0) {
                resultsDiv.innerHTML = "<p>No results found</p>";
            } else {
                data.forEach((row, index) => {
                    const resultItem = document.createElement("div");
                    resultItem.className = "result-item";
                    resultItem.innerHTML = `
                        <span>${row[0]} | ${row[1]} | ${row[2]} | ${row[3]} | ${row[4]}</span>
                        <button class="request-button" onclick="requestDetails(${index})">Request</button>
                    `;
                    resultsDiv.appendChild(resultItem);
                });
            }
        }

        // Function to handle Request button click
        function requestDetails(index) {
            alert(`Requesting details for row ${index + 1}`);
        }

        // Search button functionality
        document.getElementById("search-button").addEventListener("click", fetchData);
    </script>

</body>
</html>
